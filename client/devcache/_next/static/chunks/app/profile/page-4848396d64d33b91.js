(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},1201:(e,t,a)=>{Promise.resolve().then(a.bind(a,8648))},2334:(e,t,a)=>{"use strict";a.d(t,{E1:()=>c,L6:()=>u,gg:()=>h,q7:()=>x,tH:()=>m});var s=a(5704);let l="isf:session:v1",n=parseInt(s.env.NEXT_PUBLIC_SESSION_TTL_MS||"",10)||864e5,i=s.env.NEXT_PUBLIC_LS_SECRET||"change-me-dev";async function r(e){let t=new TextEncoder,a=await crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveKey"]),s=t.encode("isf-blood-salt-v1");return crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function d(e){try{let t=await r(i),a=crypto.getRandomValues(new Uint8Array(12)),s=new TextEncoder().encode(JSON.stringify(e)),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},t,s),n=new Uint8Array(a.byteLength+l.byteLength);return n.set(a,0),n.set(new Uint8Array(l),a.byteLength),btoa(String.fromCharCode(...n))}catch(t){return JSON.stringify({__plain:!0,data:e})}}async function o(e){try{if(e&&"string"==typeof e&&e.startsWith("{")){let t=JSON.parse(e);if(t&&t.__plain)return t.data}let t=await r(i),a=atob(e),s=Uint8Array.from(a,e=>e.charCodeAt(0)),l=s.slice(0,12),n=s.slice(12),d=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},t,n),o=new TextDecoder().decode(d);return JSON.parse(o)}catch(e){return null}}async function c(e){let{user:t,token:a,extra:s}=e,i=function(e){if(!e||"object"!=typeof e)return null;let t={...e};return Object.keys(t).forEach(e=>{/password|reset|secret|salt/i.test(e)&&delete t[e]}),t}(t),r=Date.now(),o=Math.min((a?function(e){try{let t=String(e).split(".");if(3!==t.length)return null;let a=JSON.parse(atob(t[1].replace(/-/g,"+").replace(/_/g,"/")));if(a&&"number"==typeof a.exp)return 1e3*a.exp;return null}catch(e){return null}}(a):null)||r+n,r+n),c={user:i,token:a||null,extra:s||null,ts:r,exp:o};try{let e=await d(c);return window.localStorage.setItem(l,e),c}catch(e){return null}}async function u(){try{let e=window.localStorage.getItem(l);if(!e)return null;let t=await o(e);if(!t||"object"!=typeof t||!("exp"in t)||!("ts"in t))return null;return t}catch(e){return null}}async function m(){let e=await u();return!!e&&Date.now()<Number(e.exp||0)}async function x(){try{window.localStorage.removeItem(l)}catch(e){}}function h(e){if(!e)return"—";let t=String(e);return t.length<=12?"".concat(t.slice(0,4),"•••").concat(t.slice(-4)):"".concat(t.slice(0,6),"••••••").concat(t.slice(-6))}},5490:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>r});var s=a(2334);let l="https://isf-blood.onrender.com/api/v1",n=new Map;async function i(e){let t,a,{method:i="GET",params:r,body:d,headers:o={},cache:c=!0,ttlMs:u=3e4,credentials:m="include"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e&&/^https?:\/\//i.test(e))t=e;else{let a=String(l||"").replace(/\/+$/,""),s=String(e||"").replace(/^\/+/,"");t="".concat(a,"/").concat(s)}let x=new URL(t);r&&Object.entries(r).forEach(e=>{let[t,a]=e;null!=a&&x.searchParams.set(t,String(a))});let h=function(e,t){let{method:a="GET",headers:s,body:l}=t||{},n=s?JSON.stringify(s):"",i=l?"string"==typeof l?l:JSON.stringify(l):"";return"".concat(a,":").concat(e,":").concat(n,":").concat(i)}(x.toString(),{method:i,headers:o,body:d});if(c&&"GET"===i){let e=n.get(h);if(e&&Date.now()-e.ts<e.ttlMs)return e.data}let p=d&&"object"==typeof d,g=await (0,s.L6)(),v=(null==g?void 0:g.token)?{Authorization:o.Authorization||"Bearer ".concat(g.token)}:{},y={method:i,headers:{"Content-Type":p?"application/json":o["Content-Type"]||"application/json",...v,...o},credentials:m};d&&(y.body=p?JSON.stringify(d):d);let f=await fetch(x.toString(),y);if((f.headers.get("content-type")||"").includes("application/json"))a=await f.json();else{let e=await f.text();try{a=JSON.parse(e)}catch(t){a={success:f.ok,message:e}}}if(!f.ok){let e=Error((null==a?void 0:a.message)||"Request failed");if(e.status=f.status,e.data=a,401===f.status||403===f.status){try{await (0,s.q7)()}catch(e){}e.code="AUTH_REQUIRED"}throw e}return c&&"GET"===i&&n.set(h,{ts:Date.now(),ttlMs:u,data:a}),a}let r={get:(e,t)=>i(e,{...t,method:"GET"}),post:(e,t,a)=>i(e,{...a,method:"POST",body:t}),patch:(e,t,a)=>i(e,{...a,method:"PATCH",body:t}),delete:(e,t)=>i(e,{...t,method:"DELETE"}),login:async(e,t)=>{var a,l,n,r,d,o;let c=await i("/auth/login",{method:"POST",body:{email:e,password:t}}),u=null!=(l=null==c?void 0:c.data)?l:c,m=null!=(d=null!=(r=null!=(n=null==u?void 0:u.user)?n:null==u||null==(a=u.data)?void 0:a.user)?r:null==u?void 0:u.data)?d:null,x=null!=(o=null==u?void 0:u.token)?o:null;return await (0,s.E1)({user:m,token:x,extra:{source:"login"}}),c},googleLogin:async e=>{var t,a,l,n,r;let d=await i("/auth/google",{method:"POST",body:{idToken:e}}),o=null!=(a=null==d?void 0:d.data)?a:d,c=null!=(n=null!=(l=null==o?void 0:o.user)?l:null==o||null==(t=o.data)?void 0:t.user)?n:null,u=null!=(r=null==o?void 0:o.token)?r:null;return await (0,s.E1)({user:c,token:u,extra:{source:"googleLogin"}}),d},me:async()=>{var e;let t=await i("/auth/me",{method:"GET"}),a=null!=(e=null==t?void 0:t.data)?e:t,l=await (0,s.L6)();return await (0,s.E1)({user:a,token:(null==l?void 0:l.token)||null,extra:{source:"me"}}),t},logout:async()=>{let e=await i("/auth/logout",{method:"GET"});return await (0,s.q7)(),e},updateMe:async e=>{var t;let a=await i("/auth/update-me",{method:"PATCH",body:e}),l=null!=(t=null==a?void 0:a.data)?t:a,n=await (0,s.L6)();return await (0,s.E1)({user:l,token:(null==n?void 0:n.token)||null,extra:{source:"updateMe"}}),a},updatePassword:e=>i("/auth/update-password",{method:"PATCH",body:e}),updatePassword:async e=>{var t,a,l,n,r,d,o;let c=await i("/auth/update-password",{method:"PATCH",body:e}),u=null!=(a=null==c?void 0:c.data)?a:c,m=null!=(n=null!=(l=null==u?void 0:u.user)?l:null==u||null==(t=u.data)?void 0:t.user)?n:null,x=null!=(r=null==u?void 0:u.token)?r:null,h=await (0,s.L6)();return await (0,s.E1)({user:null!=(d=null!=m?m:null==h?void 0:h.user)?d:null,token:null!=(o=null!=x?x:null==h?void 0:h.token)?o:null,extra:{source:"updatePassword"}}),c},addAddress:e=>i("/users/address",{method:"PUT",body:e}),deleteAddress:e=>i("/users/address/".concat(e),{method:"DELETE"}),setDefaultAddress:e=>i("/users/address/".concat(e,"/default"),{method:"PUT"}),dashboard:()=>i("/users/dashboard",{method:"GET"}),updateAvatar:async e=>{var t;let a,n=new FormData;n.append("avatar",e);let i=await (0,s.L6)(),r=(null==i?void 0:i.token)?{Authorization:"Bearer ".concat(i.token)}:{},d=String(l||"").replace(/\/+$/,""),o=await fetch("".concat(d,"/users/avatar"),{method:"PUT",body:n,headers:{...r},credentials:"include"});if((o.headers.get("content-type")||"").includes("application/json"))a=await o.json();else{let e=await o.text();try{a=JSON.parse(e)}catch(t){a={success:o.ok,message:e}}}if(!o.ok){if(401===o.status||403===o.status)try{await (0,s.q7)()}catch(e){}let e=Error((null==a?void 0:a.message)||"Avatar upload failed");throw e.status=o.status,e.data=a,e}let c=null!=(t=null==a?void 0:a.data)?t:a,u=await (0,s.L6)();return await (0,s.E1)({user:c,token:(null==u?void 0:u.token)||null,extra:{source:"updateAvatar"}}),a},listDonations:async()=>{let e=await i("/users/donations",{method:"GET"});return(null==e?void 0:e.data)||e},addDonation:async e=>{let{date:t,hospital:a,units:s}=e,l=await i("/users/donations",{method:"POST",body:{date:t,hospital:a,units:s}});return(null==l?void 0:l.data)||l},getDonor:async(e,t)=>{let a=await i("/donors/".concat(e),{method:"GET",params:t});return(null==a?void 0:a.data)||a}}},6485:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},8648:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(5155),l=a(2115),n=a(63),i=a(5239),r=a(1847);let d=(0,r.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var o=a(3664),c=a(9141),u=a(1873),m=a(3457);let x=(0,r.A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var h=a(6485),p=a(5490),g=a(2334);function v(e){return({"A+":"from-red-400 to-red-600","A-":"from-red-400 to-red-600","B+":"from-blue-400 to-blue-600","B-":"from-blue-400 to-blue-600","AB+":"from-purple-400 to-purple-600","AB-":"from-purple-400 to-purple-600","O+":"from-green-400 to-green-600","O-":"from-orange-400 to-orange-600"})[e]||"from-gray-400 to-gray-600"}function y(){var e;let t=(0,n.useRouter)(),[a,r]=(0,l.useState)(!1),[y,b]=(0,l.useState)(!0),[w,N]=(0,l.useState)(!1),[j,S]=(0,l.useState)(null),[A,k]=(0,l.useState)(""),[C,E]=(0,l.useState)(null),[P,_]=(0,l.useState)({name:"",email:"",phone:""}),[T,D]=(0,l.useState)([]),[L,O]=(0,l.useState)({line1:"",city:"",state:"",pincode:"",country:"India",is_default:!1,address_type:"shipping"}),[U,M]=(0,l.useState)(!1),[B,F]=(0,l.useState)(""),[I,G]=(0,l.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[R,H]=(0,l.useState)([]),[J,q]=(0,l.useState)(!1),[K,z]=(0,l.useState)(""),[$,Q]=(0,l.useState)({date:"",hospital:"",units:1});(0,l.useEffect)(()=>{let e=!0;return async function(){b(!0),S(null);let a=!1;try{let s=await (0,g.L6)(),l=await (0,g.tH)();if(!e)return;if(null==s?void 0:s.user){let e=s.user;E(e),_({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||(null==e?void 0:e.phoneNumber)||""}),D((null==e?void 0:e.addresses)||[])}else{let t=await p.Ay.me(),s=(null==t?void 0:t.data)||t;if(a=!0,!e)return;E(s),_({name:(null==s?void 0:s.name)||"",email:(null==s?void 0:s.email)||"",phone:(null==s?void 0:s.phone)||(null==s?void 0:s.phoneNumber)||""}),D((null==s?void 0:s.addresses)||[])}l||a||t.replace("/login")}catch(e){var s;S((null==e||null==(s=e.data)?void 0:s.message)||(null==e?void 0:e.message)||"Failed to initialize profile"),((null==e?void 0:e.code)==="AUTH_REQUIRED"||(null==e?void 0:e.status)===401)&&t.replace("/login")}finally{e&&b(!1)}}(),()=>{e=!1}},[]),(0,l.useEffect)(()=>{let e=!0;return async function(){if(C){q(!0),z("");try{let t=await p.Ay.listDonations(),a=(null==t?void 0:t.donations)||[];e&&H(a)}catch(a){var t;e&&z((null==a||null==(t=a.data)?void 0:t.message)||(null==a?void 0:a.message)||"Failed to load donation history")}finally{e&&q(!1)}}}(),()=>{e=!1}},[C]);let V=(0,l.useMemo)(()=>((null==C?void 0:C.name)||P.name||"").trim().split(" ").filter(Boolean).map(e=>e[0]).join("").slice(0,2).toUpperCase()||"U",[C,P.name]),W=(0,l.useMemo)(()=>{let e=(null==C?void 0:C.created_at)||(null==C?void 0:C.createdAt);if(!e)return"";try{return new Date(e).toLocaleString(void 0,{month:"long",year:"numeric"})}catch(e){return""}},[C]);async function X(){var e,t;S(null),k("");let a={name:String(P.name||"").trim().replace(/[<>]/g,""),email:String(P.email||"").trim(),phone:String(P.phone||"").trim().replace(/[^\d+\-()\s]/g,"")};if(!a.name)return void S("Name is required");if(e=a.email,!/^\S+@\S+\.\S+$/.test(String(e||"").trim()))return void S("Please provide a valid email");if(a.phone&&!(String(a.phone||"").replace(/\D/g,"").length>=10))return void S("Please provide a valid phone number");N(!0);try{let e=await p.Ay.updateMe(a),t=(null==e?void 0:e.data)||e;E(t),_({name:(null==t?void 0:t.name)||"",email:(null==t?void 0:t.email)||"",phone:(null==t?void 0:t.phone)||(null==t?void 0:t.phoneNumber)||""}),k("Profile updated successfully"),r(!1)}catch(e){S((null==e||null==(t=e.data)?void 0:t.message)||(null==e?void 0:e.message)||"Failed to update profile")}finally{N(!1)}}async function Y(){S(null),k("");let e={line1:String(L.line1||"").trim(),city:String(L.city||"").trim(),state:String(L.state||"").trim(),pincode:String(L.pincode||"").trim(),country:String(L.country||"").trim()||"India",is_default:!!L.is_default,address_type:String(L.address_type||"shipping")};if(!e.line1||!e.city||!e.state||!/^\d{6}$/.test(e.pincode))return void S("Please fill all address fields with a valid 6-digit pincode");try{let t=await p.Ay.addAddress(e),a=(null==t?void 0:t.data)||t;D((null==a?void 0:a.addresses)||[]),k("Address added"),O({line1:"",city:"",state:"",pincode:"",country:"India",is_default:!1,address_type:"shipping"})}catch(e){var t;S((null==e||null==(t=e.data)?void 0:t.message)||(null==e?void 0:e.message)||"Failed to add address")}}async function Z(e){S(null),k("");try{let t=await p.Ay.deleteAddress(e),a=(null==t?void 0:t.data)||t;D((null==a?void 0:a.addresses)||[]),k("Address deleted")}catch(e){var t;S((null==e||null==(t=e.data)?void 0:t.message)||(null==e?void 0:e.message)||"Failed to delete address")}}async function ee(e){S(null),k("");try{let t=await p.Ay.setDefaultAddress(e),a=(null==t?void 0:t.data)||t;D((null==a?void 0:a.addresses)||[]),k("Default address updated")}catch(e){var t;S((null==e||null==(t=e.data)?void 0:t.message)||(null==e?void 0:e.message)||"Failed to set default address")}}async function et(){S(null),k("");let{currentPassword:e,newPassword:t,confirmPassword:a}=I;if(!e||!t)return void S("Please fill all password fields");if(t.length<8)return void S("New password must be at least 8 characters");if(t!==a)return void S("New password and confirmation do not match");N(!0);try{await p.Ay.updatePassword({currentPassword:e,newPassword:t}),k("Password updated successfully"),G({currentPassword:"",newPassword:"",confirmPassword:""})}catch(e){var s;S((null==e||null==(s=e.data)?void 0:s.message)||(null==e?void 0:e.message)||"Failed to update password")}finally{N(!1)}}async function ea(){z("");let{date:e,hospital:t,units:a}=$;if(!e||!t||!a)return void z("Please fill date, hospital, and units");try{let s=await p.Ay.addDonation({date:e,hospital:String(t).trim(),units:Number(a)}),l=(null==s?void 0:s.donations)||[];H(l),Q({date:"",hospital:"",units:1})}catch(e){var s;z((null==e||null==(s=e.data)?void 0:s.message)||(null==e?void 0:e.message)||"Failed to add donation")}}async function es(e){var t,a;let s=null==(t=e.target.files)?void 0:t[0];if(s){F(""),M(!0);try{let e=await p.Ay.updateAvatar(s),t=(null==e?void 0:e.data)||e;E(t),k("Avatar updated successfully")}catch(e){F((null==e||null==(a=e.data)?void 0:a.message)||(null==e?void 0:e.message)||"Failed to update avatar")}finally{M(!1)}}}return y?(0,s.jsx)("div",{className:"min-h-screen bg-background py-8",children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-32 bg-gray-200 rounded-isf-lg"}),(0,s.jsx)("div",{className:"h-24 bg-gray-200 rounded-isf-lg"}),(0,s.jsx)("div",{className:"h-40 bg-gray-200 rounded-isf-lg"})]})})}):(0,s.jsx)("div",{className:"min-h-screen bg-background py-8",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf overflow-hidden mb-6",children:[(0,s.jsx)("div",{className:"h-32 bg-gradient-to-r ".concat(v("—")," relative"),children:(0,s.jsx)("div",{className:"absolute top-4 right-4",children:(0,s.jsx)("button",{onClick:()=>r(!a),className:"p-2 bg-white/20 backdrop-blur-sm rounded-full text-white hover:bg-white/30 transition-colors duration-200",children:(0,s.jsx)(d,{className:"w-4 h-4"})})})}),(0,s.jsxs)("div",{className:"px-6 pb-6",children:[(0,s.jsxs)("div",{className:"relative -mt-16 mb-4",children:[(null==C?void 0:C.avatar)?(0,s.jsx)("div",{className:"mx-auto w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-lg",children:(0,s.jsx)(i.default,{src:C.avatar,alt:"User avatar",width:96,height:96,className:"object-cover w-full h-full",priority:!0})}):(0,s.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-primary to-primary-dark rounded-full border-4 border-white flex items-center justify-center text-white font-bold text-2xl mx-auto shadow-lg",children:V}),(0,s.jsx)("div",{className:"absolute bottom-2 right-1/2 transform translate-x-12 w-6 h-6 bg-green-500 rounded-full border-2 border-white"})]}),(0,s.jsx)("div",{className:"mt-3 flex items-center justify-center",children:(0,s.jsxs)("label",{className:"inline-flex items-center px-3 py-1 text-xs sm:text-sm bg-white border rounded cursor-pointer hover:bg-gray-50",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:es}),U?"Uploading…":"Change Avatar"]})}),B&&(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-red-600",children:B}),(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:(null==C?void 0:C.name)||P.name}),(0,s.jsx)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:(0,s.jsx)("span",{className:"px-4 py-2 bg-gradient-to-r ".concat(v("—")," text-white rounded-full font-semibold text-lg"),children:"—"})}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Member since ",W]})]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(f,{})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-red-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-red-600 mb-1",children:"—"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Blood Type"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:0}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Donations"})]}),(0,s.jsxs)("div",{className:"bg-green-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:0}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Lives Impacted"})]})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-primary to-primary-dark rounded-isf-lg p-6 text-center text-white mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"One Drop Can Save a Life"}),(0,s.jsx)("p",{className:"text-sm opacity-90 mb-4",children:"Keep making a difference—every contribution matters!"}),(0,s.jsx)("button",{className:"bg-white text-primary px-6 py-2 rounded-full font-semibold hover:bg-gray-100 transition-colors duration-200",children:"Donate Now"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),j&&(0,s.jsx)("div",{className:"mb-4 p-3 rounded bg-red-50 text-red-700 border border-red-200",children:j}),A&&(0,s.jsx)("div",{className:"mb-4 p-3 rounded bg-green-50 text-green-700 border border-green-200",children:A}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(o.A,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Email"}),a?(0,s.jsx)("input",{type:"email",className:"mt-1 w-full border rounded px-3 py-2 text-sm",value:P.email,onChange:e=>_(t=>({...t,email:e.target.value}))}):(0,s.jsx)("div",{className:"font-medium break-all",children:null==C?void 0:C.email})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Phone"}),a?(0,s.jsx)("input",{type:"tel",className:"mt-1 w-full border rounded px-3 py-2 text-sm",value:P.phone,onChange:e=>_(t=>({...t,phone:e.target.value}))}):(0,s.jsx)("div",{className:"font-medium",children:(null==C?void 0:C.phone)||(null==C?void 0:C.phoneNumber)||"—"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(u.A,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Default City"}),(0,s.jsx)("div",{className:"font-medium",children:(null==T||null==(e=T[0])?void 0:e.city)||"—"})]})]})]}),(0,s.jsx)("div",{className:"mt-4 flex justify-end gap-2",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:function(){S(null),k(""),_({name:(null==C?void 0:C.name)||"",email:(null==C?void 0:C.email)||"",phone:(null==C?void 0:C.phone)||(null==C?void 0:C.phoneNumber)||""}),r(!1)},className:"px-4 py-2 border rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:X,className:"px-4 py-2 bg-primary text-white rounded disabled:opacity-50",disabled:w,children:w?"Saving...":"Save"})]}):(0,s.jsx)("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-primary text-white rounded",children:"Edit Profile"})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Addresses"}),(0,s.jsx)("div",{className:"space-y-2",children:(T||[]).map(e=>(0,s.jsxs)("div",{className:"flex items-start justify-between p-3 bg-gray-50 rounded-isf",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,s.jsx)("div",{className:"font-medium",children:e.line1}),(0,s.jsxs)("div",{children:[e.city,", ",e.state," ",e.pincode]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.country})]}),e._id&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[!e.is_default&&(0,s.jsx)("button",{onClick:()=>ee(e._id),className:"text-sm text-primary hover:text-primary-dark",children:"Set default"}),(0,s.jsx)("button",{onClick:()=>Z(e._id),className:"text-sm text-red-600 hover:text-red-700",children:"Delete"})]})]},e._id||"".concat(e.line1,"-").concat(e.city)))}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:[(0,s.jsx)("input",{className:"border rounded px-3 py-2 text-sm",placeholder:"Line 1",value:L.line1,onChange:e=>O(t=>({...t,line1:e.target.value}))}),(0,s.jsx)("input",{className:"border rounded px-3 py-2 text-sm",placeholder:"City",value:L.city,onChange:e=>O(t=>({...t,city:e.target.value}))}),(0,s.jsx)("input",{className:"border rounded px-3 py-2 text-sm",placeholder:"State",value:L.state,onChange:e=>O(t=>({...t,state:e.target.value}))}),(0,s.jsx)("input",{className:"border rounded px-3 py-2 text-sm",placeholder:"Pincode",value:L.pincode,onChange:e=>O(t=>({...t,pincode:e.target.value}))}),(0,s.jsx)("input",{className:"border rounded px-3 py-2 text-sm",placeholder:"Country",value:L.country,onChange:e=>O(t=>({...t,country:e.target.value}))})]}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:L.is_default,onChange:e=>O(t=>({...t,is_default:e.target.checked}))})," Set as default"]}),(0,s.jsxs)("select",{className:"text-sm border rounded px-2 py-1",value:L.address_type,onChange:e=>O(t=>({...t,address_type:e.target.value})),children:[(0,s.jsx)("option",{value:"shipping",children:"Shipping"}),(0,s.jsx)("option",{value:"billing",children:"Billing"})]}),(0,s.jsx)("button",{onClick:Y,className:"ml-auto bg-primary text-white px-3 py-1 rounded disabled:opacity-50",disabled:w,children:"Add Address"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Security"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,s.jsx)("input",{type:"password",placeholder:"Current password",className:"border rounded px-3 py-2 text-sm",value:I.currentPassword,onChange:e=>G(t=>({...t,currentPassword:e.target.value}))}),(0,s.jsx)("input",{type:"password",placeholder:"New password",className:"border rounded px-3 py-2 text-sm",value:I.newPassword,onChange:e=>G(t=>({...t,newPassword:e.target.value}))}),(0,s.jsx)("input",{type:"password",placeholder:"Confirm new password",className:"border rounded px-3 py-2 text-sm sm:col-span-2",value:I.confirmPassword,onChange:e=>G(t=>({...t,confirmPassword:e.target.value}))})]}),(0,s.jsx)("div",{className:"mt-3 flex justify-end",children:(0,s.jsx)("button",{onClick:et,className:"px-4 py-2 bg-primary text-white rounded disabled:opacity-50",disabled:w,children:w?"Updating…":"Update Password"})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Donation History"}),J?(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Loading donation history…"}):K?(0,s.jsx)("div",{className:"text-sm text-red-600",children:K}):0===R.length?(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"No donations recorded yet."}):(0,s.jsx)("div",{className:"space-y-3",children:R.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-isf",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:(0,s.jsx)(m.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.hospital}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.date).toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.units," unit",Number(e.units)>1?"s":""]})]},t))}),(0,s.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Add Donation"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[(0,s.jsx)("input",{type:"date",className:"border rounded px-3 py-2 text-sm",value:$.date,onChange:e=>Q(t=>({...t,date:e.target.value}))}),(0,s.jsx)("input",{type:"text",placeholder:"Hospital",className:"border rounded px-3 py-2 text-sm",value:$.hospital,onChange:e=>Q(t=>({...t,hospital:e.target.value}))}),(0,s.jsx)("input",{type:"number",min:"1",max:"10",placeholder:"Units",className:"border rounded px-3 py-2 text-sm",value:$.units,onChange:e=>Q(t=>({...t,units:Number(e.target.value)}))})]}),(0,s.jsx)("div",{className:"mt-2 flex justify-end",children:(0,s.jsx)("button",{onClick:ea,className:"px-4 py-2 bg-primary text-white rounded disabled:opacity-50",disabled:J,children:"Add"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Badges & Achievements"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:["First Donor","Regular Donor"].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-yellow-50 rounded-isf",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(x,{className:"w-4 h-4 text-white"})}),(0,s.jsx)("span",{className:"font-medium text-gray-900",children:e})]},t))})]}),(0,s.jsxs)("div",{className:"bg-white rounded-isf-lg shadow-isf p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Next Donation Eligibility"}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-blue-50 rounded-isf",children:[(0,s.jsx)(h.A,{className:"w-8 h-8 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"We will notify you when you are eligible again"}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"You can donate blood again after this date"})]})]})]})]})})}function f(){let[e,t]=(0,l.useState)("—"),[a,n]=(0,l.useState)(null),[i,r]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=!0;return async function(){let a=await (0,g.L6)();e&&(t((0,g.gg)(null==a?void 0:a.token)),n(!!a&&Date.now()<Number(a.exp||0)),r((null==a?void 0:a.exp)||null))}(),()=>{e=!1}},[]),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Auth Token"}),(0,s.jsx)("div",{className:"text-sm font-mono break-all",children:e})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Session Valid"}),(0,s.jsx)("div",{className:"text-sm font-semibold ".concat(a?"text-green-600":"text-red-600"),children:null===a?"—":a?"Yes":"No"})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-isf p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Expires"}),(0,s.jsx)("div",{className:"text-sm",children:i?new Date(i).toLocaleString():"—"})]})]})}}},e=>{e.O(0,[756,441,493,358],()=>e(e.s=1201)),_N_E=e.O()}]);